# logrotate

Loop logging of standard inputs to several files

This is a command-line tool for circularly writing the output of other programs to some files via a pipe ("|").

Written using ulog's asynchronous fifo and extended headers for file loop writing.

## Base Usage

```shell
your_program | logrotate --file-path /tmp/example/log.txt --file-size=100KB --max-files=3
```

This will output the output of your program to `/tmp/example/log.txt` through `logrotate`, and limit the size and number of a single file according to the options.

Eventually there will be `log.3.txt, log.2.txt, log.1.txt, log.txt` in the `/tmp/example` directory.

These files will circulate in the order `log.(N).txt -> log.(N+1).txt`, and always keep at least 3 complete files.

The `log.txt` can be viewed in real time using `tail -F /tmp/example/log.txt`.

## Advanced Usage

```shell
your_program | logrotate --file-path /tmp/example/log.txt --file-size=10MB --max-files=8 --flush-interval=3s --zstd-compress --zstd-params=level=3,window-log=16,chain-log=12,hash-log=13 
```

Please refer to the following command line options for more advanced usage.

## Command line options

```bash
> logrotate --help
Usage: logrotate -f PATH [OPTIONS]...
Loop logging of standard inputs to several files.

  -h, --help                 Print help and exit
  -V, --version              Print version and exit
  -f, --file-path=PATH       File path to record log
  -s, --file-size=SIZE       Size of each file (e.g., 1MB, 500KB, 2GB)
                               (default=`1MB')
  -n, --max-files=NUM        Maximum number of files  (default=`8')
  -c, --fifo-size=SIZE       Fifo size  (default=`32KB')
  -i, --flush-interval=TIME  The time interval between flushing to disk or
                               writing the compression end mark and flushing to
                               disk (e.g., 1, 3s, 500ms, 5min)  (default=`1s')
  -z, --zstd-compress        Compress with zstd  (default=off)
  -p, --zstd-params=params   Parameters for zstd compression,
                               larger == more compression and memory (e.g.,
                               level=3,window-log=21,chain-log=16,hash-log=17)
  -r, --rotate-first         Should rotate first before write  (default=off)

The SIZE parameter units are K, M, G (power of 1024). If the unit is not
specified, the default is bytes.
The TIME parameter units are s, sec, ms, min, hour. If the unit is not
specified, the default is seconds.
```

Command line options are generated by the gnu [gengetopt](https://www.gnu.org/software/gengetopt) tool with `getopt`.  `cmdline.c/h` files are generated by the `gengetopt < logrotate_getopt.ggo` command.
